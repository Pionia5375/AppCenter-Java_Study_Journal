데이터와 정보

1. 데이터: 가공되지 않은 사실, 수치, 문자열 등
2. 구조화된 데이터: 정형화된 데이터, 정해진 형식에 따라 저장된 데이터
3. 정보: 가공된 데이터, 의미를 가지는 데이터

데이터베이스와 데이터베이스 관리 시스템

1. 데이터베이스: 데이터를 저장하는 공간
2. 데이터베이스 관리 시스템: 데이터를 관리하는 시스템

데이터베이스 관리 시스템이 필요한 이유

1. 데이터 무결성: 데이터의 정확성과 일관성을 유지
2. 데이터 보안: 데이터의 접근을 제어하고 권한을 관리
3. 데이터 회복: 데이터의 손실을 방지하고 복구
4. 데이터 공유: 여러 사용자가 데이터를 공유
5. 데이터 중복 최소화: 데이터의 중복을 방지
6. 데이터 동시성 문제 해소: 하나의 데이터가 업데이트 되었을 때, 다른 사용자가 접근할 수 있도록 함.

데이터 무결성 제약조건: 데이터에는 일정한 규칙과 제약이 있어야 한다. (ex> 나이에는 음수가 올 수 없다. 회원의 아이디는 중복되어서는 안된다.)

DBMS는 데이터베이스에서 데이터를 간단하게 CRUD 할 수 있도록 도와주는 프로그램이다.
CRUD: Create, Read, Update, Delete

데이터를 보다 체게적이고, 안전하며, 효율적으로 관리하기 위해 데이터베이스를 사용한다.
DBMS는 도서관의 유능한 사서와 같다.

DBMS는 데이터 CRUD 외에도, 보안, 동시성, 트랜잭션 관리, 파일 시스템 오류 해결, 데이터 중복 해소(정규화) 등 여러 업무를 수행한다.

rdb의 용어들

테이블: 데이터를 저장하는 공간
행: 테이블의 한 줄 (튜플, 레코드)
열: 테이블의 한 칸 (속성, 필드)

기본키
1. 중복이 없어야 한다.
2. null 값을 가질 수 없다.
3. 테이블당 하나만 존재한다.

외래키: 한 테이블의 열이 다른 테이블의 기본키를 참조하는 키
FK를 제공하는 테이블은 부모 테이블, FK를 가진 테이블을 자식 테이블이라고 한다.
부모테이블: 참조당하는 테이블
자식테이블: 참조하는 테이블

외래키의 참조 무결성 제약조건: 부모 테이블에 존재하지 않는 값을 자식 테이블에 입력할 수 없다. 참조하는 값이 반드시 부모테이블의 기본 키값으로 존재하거나, null 값을 가져야 한다. -> 데이터의 정합성 보존.

CREATE DATABASE 와 같이 sql에서 기본적으로 제공하는 키워드들에는 대문자를 사용하고, 테이블명이나 컬럼명에는 소문자를 사용한다.
데이터베이스의 이름은 보통 소문자에 언더스코어를 주로 사용한다.


CREATE DATABASE 데이터테이스명: 데이터베이스 생성
USE 데이터베이스명: 데이터베이스 사용
DESC 데이터베이스명 / DESCRIBE 데이터베이스명: 데이터베이스 구조 확인
SHOW DATABASES / TABLES: 데이터베이스 목록 확인 / 테이블 목록 확인
DROP DATABASE 데이터베이스명: 데이터베이스 삭제

INSERT INTO 테이블명 (컬럼명1, 컬럼명2, ...) VALUES (값1, 값2, ...): 데이터 삽입
SELECT * FROM 테이블명: 데이터 조회

UPDATE 테이블명
SET 컬럼명 = 변경할 데이터
WHERE 조건

DELETE FROM 테이블명
WHERE 조건

데이터베이스는 사실 키워드에 대소문자를 구별하지 않지만, 실무에서는 보통 키워드를 대문자로, 테이블명이나 컬럼명은 소문자로 작성한다.

SQL: Structured Query Language
SQL은 국제표준기구에서 지정된 RDB의 표준 언어이다.
MySQL, MariaDB, Oracle, SQL Server, PostgreSQL 등 RDB 제조사마다 SQL을 조금씩 다르게 구현해 놓았다(추가 기능이나 문법 차이). 이를 "방언"이라고 부른다.
SQL은 선언적 언어이다. 즉, "어떻게" 데이터를 처리할 지가 아니라 "무엇을" 원하는 지를 명시한다. (할 일을 일일이 명시하는 프로그래밍과의 차이. 뭘 원하는지만 선언적으로 명시한다.)


SQL 명령어의 4가지 분류
1. DDL (Data Definition Language): 데이터 정의어: 데이터의 구조를 정의하고 관리
2. DML (Data Manipulation Language): 데이터 조작어: 데이터베이스 안에 존재하는 실제 대이터를 조작 (CRUD)
3. DCL (Data Control Language): 데이터 제어어: 데이터베이스의 접근 권한을 관리 (보안 관리)
4. TCL (Transaction Control Language): 트랜잭션 제어어 : DML에 의해 수행된 데이터 변경 작업들을 하나의 작업(트랜잭션)으로 묶어 관리

트랜잭션
- commit: 트랜잭션의 모든 작업을 성공적으로 완료했음을 선언
- rollback: 트랜잭션의 모든 작업을 취소하고 이전 상태로 되돌림

문자열 타입을 고려할 때, 대부분의 경우 VARCHAR를 사용한다. VARCHAR는 가변 길이 문자열로, 저장되는 데이터의 길이에 따라 메모리를 효율적으로 사용할 수 있다.
그러나 문자열의 길이가 완벽하게 고정되어 있다면 CHAR을 사용하는 것이 더 효율적일 수 있다. (ex> 주민등록번호, 전화번호 등)

날짜 타입
DATE: 날짜
TIME: 시간
DATETIME: 날짜와 시간
TIMESTAMP: 날짜와 시간 (UTC 기준): 현재 서버시간을 협정 세계시 기준으로 변환하여 저장, 조회할 때에는 다시 협정 세계시를 현재 서버시간으로 변환하여 반환. (시간대 변환에 유리)

최근에는 보통 실무에서 DATETIME을 사용한다. 요구하는 용량차이가 크지 않고 (1바이트), TIMESTAMP에서 제공하는 현재 시간 기록 기능을 DATETIME에서도 제공하기 때문. 오히려 TIMESTAMP는 사용가능한 미래 시간이 제항되어 있기 때문에, 제한이 없는 DATETIME을 더욱 선호한다.

BLOB: Binary Large Object: 이미지와 같은 대용량 바이너리 파일을 저장할 때 사용

제약조건들
NOT NULL: NULL 값을 가질 수 없다.
UNIQUE: 중복된 값을 가질 수 없다.
PRIMARY KEY: 기본키, * AUTO_INCREMENT: 새로운 데이터가 추가되었을 때, 기본키의 값을 자동으로 증가시킨다.
FOREIGN KEY: 외래키
DEFAULT: 기본값 속성: 해당 컬럼에 데이터가 입력되지 않았을 때, 기본값으로 설정된 값을 사용한다.
CHECK: 컬럼에 입력되는 데이터가 지정된 조건을 충족해야 한다.

DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP: 데이터가 입력되면, 현재 시간을 기본값으로 설정한다. 데이터가 수정되었을 때, 현재 시간으로 업데이트한다.

ALTER TABLE 테이블명
MODIFY COLUMN 컬럼명 데이터타입

ALTER TABLE 테이블명
DROP COLUMN 컬럼명

테이블의 구조를 변경하는 작업은 시간을 비롯한 자원이 많이 소요되므로, 신중하게 사용하는 것이 좋다.


DROP TABLE과 TRUNCATE TABLE의 차이
DROP TABLE: 테이블 자체를 삭제
TRUNCATE TABLE: 테이블의 데이터만 삭제

SET FOREIGN_KEY_CHECKS = 0; -- 외래키 제약 조건 해제
SET FOREIGN_KEY_CHECKS = 1; -- 외래키 제약 조건 재설정 // 재접속 시 자동으로 다시 활성화됨

UPDATE 테이블명
SET 컬럼명 = 변경할 데이터
WHERE 조건

을 사용할 때, WHERE 조건을 사용하지 않으면, 테이블의 모든 데이터가 변경된다.

실수를 방지하기 위해, 보통 @@SQL_SAFE_UPDATES를 1로 설정한다.

UPDATE 테이블명
SET 컬럼명 = 변경할 데이터
WHERE 조건

@@SQL_SAFE_UPDATES;

이렇게 설정하면, WHERE 조건에 반드시 해당 테이블의 기본키를 명시해야 한다.

@@SQL_SAFE_UPDATES는 DELETE문에서도 동작한다. 반드시 동작 쿼리 아래에 설정해야 한다. 

선별적인 삭제를 하나하나 삭제할 때: DELETE
테스트 데이터 전체를 일괄 삭제할 때: TRUNCATE

NULL값은 특정 값이 아니기 때문에 = 와 같은 연산자로 비교할 수 없다. IS NULL 또는 IS NOT NULL을 사용해야 한다.
NULL을 정렬할 때, 오름차순 시 NULL이 먼저, 내림차순 시 NULL이 나중에 온다. (MySQL 기준)

SQL 실행순서
1. FROM
2. WHERE
3. GROUP BY
4. HAVING
5. SELECT
6. ORDER BY
7. LIMIT


예시 쿼리문
SELECT
    customer_name,
    SUM(price * quantity) AS total_purchase -- 5단계
FROM
    order_stat -- 1단계
WHERE
    order_date >= '2023-01-01' -- 2단계
GROUP BY
    customer_name -- 3단계
HAVING
    COUNT(*) >= 5 -- 4단계
ORDER BY
    total_purchase DESC -- 6단계
LIMIT 10; -- 7단계